<div class="container" gcweb>
  <div class="row" *ngVar="(collectionRD$ | async) as collectionRD">
    <div *ngIf="collectionRD?.hasSucceeded" @fadeInOut class="col-md-12">
      <ng-container *ngIf="collectionRD?.payload as collection">
        <ds-view-tracker [object]="collection"></ds-view-tracker>          

        <!-- Collection Name -->
        <ds-comcol-page-header [name]="(['dc.title', 'dc.title.fosrctranslation'] | metaTranslate : collection)[0]?.value" [lang]="(['dc.title', 'dc.title.fosrctranslation'] | metaTranslate : collection)[0]?.language"><span *ngIf="searchSubmit">{{'comcol.search.title.search.results.for' | translate}}&nbsp;</span></ds-comcol-page-header>

        <!-- Handle -->
        <ds-comcol-page-handle *ngIf="!searchSubmit" [useHeading]="false"
                [content]="collection.handle"
                [title]="'collection.page.handle'" >
        </ds-comcol-page-handle>

        <ds-comcol-page-content *ngIf="!searchSubmit" [content]="(['dc.description', 'dc.description.fosrctranslation'] | metaTranslate : collection)[0]?.value" [lang]="(['dc.description.abstract', 'dc.description.abstract-fosrctranslation'] | metaTranslate : collection)[0]?.language" [hasInnerHtml]="true">
        </ds-comcol-page-content>

        <div class="pl-2">  
          <ds-dso-page-edit-button *ngIf="isCollectionAdmin$ | async"  [pageRoute]="collectionPageRoute$ | async" [dso]="collection" [tooltipMsg]="'collection.page.edit'"></ds-dso-page-edit-button>
        </div>

        <!-- Browse-By Links -->
        <ds-comcol-page-browse-by *ngIf="!searchSubmit"
                [id]="collection.id"
                [contentType]="collection.type">
        </ds-comcol-page-browse-by>

        <div class="mrgn-tp-md">

          <h2 *ngIf="!searchSubmit">{{'collection.page.search' | translate}}</h2>

          <ds-search-form *ngIf="searchEnabled" id="search-form"
            [query]="(searchOptions$ | async)?.query"
            [(scope)]="currentScope"
            [currentUrl]="searchLink"
            [scopes]="(scopeListRD$ | async)"
            [inPlaceSearch]="inPlaceSearch"
            [onComColPage]="true"
            (submitSearch)="onSeachSubmit($event)">
          </ds-search-form>

        </div>

        <ds-comcol-search-filter *ngIf="searchEnabled && (searchOptions$ | async)?.query"
          [query]="(searchOptions$ | async)?.query"
          [(scope)]="currentScope"
          [inPlaceSearch]="inPlaceSearch"
          (submitSearch)="onSeachSubmit($event)">
        </ds-comcol-search-filter>
        
        <!-- Browse-By Links -->
        <ds-comcol-page-browse-by *ngIf="searchSubmit"
                [id]="collection.id"
                [contentType]="collection.type">
        </ds-comcol-page-browse-by>

        <ng-container *ngVar="(itemRD$ | async) as itemRD">
          <div class="row">
            <div gcweb class="col-12 pull-left">
                <!-- <ng-template *ngTemplateOutlet="searchForm"></ng-template> -->
                <hr>
                <h2>{{'collection.page.browse.recent.head' | translate}}</h2>
      
                <!-- <ds-search-settings [searchOptions]="searchOptions$ | async" [sortOptions]="sortOptions$ | async"></ds-search-settings> -->
      
                <div ds-search-settings [searchOptions]="searchOptions$ | async" [sortOptions]="sortOptions$ | async" [useGcWeb]="true" [onComColPage]="true" class="row well well-small mrgn-lft-0 mrgn-rght-0"></div>
            </div>
            <div gcweb id="search-content" class="col-12">
                <ds-search-results [searchResults]="resultsRD$ | async"
                                    [searchConfig]="searchOptions$ | async"
                                    [configuration]="configuration$ | async"
                                    [useGcWeb]="true"
                                    [disableHeader]="!searchEnabled"
                                    [context]="context"
                                    [hidePaginationDetail]="true"
                                    ></ds-search-results>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>
    <ds-error *ngIf="collectionRD?.hasFailed"
        message="{{'error.collection' | translate}}"></ds-error>
    <ds-loading *ngIf="collectionRD?.isLoading"
        message="{{'loading.collection' | translate}}"></ds-loading>
  </div>
  <ds-page-details></ds-page-details>  
</div>
